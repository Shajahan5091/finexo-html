<!DOCTYPE html>
<html>
<head>
  <!-- Basic -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- Mobile Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- Site Metas -->
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <link rel="shortcut icon" href="{{ url_for('static',filename='Image/logo.png') }}" type="">
  <title> Snow Migrate </title>
  <!-- bootstrap core css -->
  <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='styles/bootstrap.css') }}" />
  <!-- fonts style -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
  <!--owl slider stylesheet -->
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />
  <!-- font awesome style -->
  <link href="{{ url_for('static',filename='styles/font-awesome.min.css') }}" rel="stylesheet" />
  <!-- Custom styles for this template -->
  <link href="{{ url_for('static',filename='styles/style.css') }}" rel="stylesheet" />
  <!-- responsive style -->
  <link href="{{ url_for('static',filename='styles/responsive.css') }}" rel="stylesheet" />
  <style>
    .popup1 {
  /* display: none; 
  position: fixed;*/
  /* top: 100%;
  left: 50%; 
  transform: translate(-50%, -50%); */
  background-color: white;
  border-radius : 10px;
  z-index: 1000;
  /* min-width: 400px; */
  box-shadow: 0 0 10pt 1pt #D3D3D3;

  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
  /* -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center; */
  /* text-align: center; */
  margin-top: 45px;
  /* background-color: #f8f8f9; */
  /* padding: 20px; */
  /* border-radius: 5px; */
  height: 200px;
}
#heading1{
  background:#072A6C ;
  padding: 7px;
  color:white;
  border-radius : 10px 10px 0px 0px;
}
#heading1 input{
  margin-top: 10px;
  margin-left: 10px;
}
#heading1 label{
  font-weight: bold;
}
#content1{
  padding: 60px;
  /* height: 300px; */
}
ul{
  margin-top: 5px;
}
.connect-btn{
  margin-bottom: 0;
  margin-top: 10px;
}

#submit-btn{
  margin-left: 50%;
  margin-bottom: 50px;
  margin-top: 10px;
}
  </style>
</head>

<body class="sub_page">
  <div class="hero_area">
    <div class="hero_bg_box">
      <div class="bg_img_box">
        <img src="{{ url_for('static',filename='Image/hero-bg.png') }}" alt="">
      </div>
    </div>
    <!-- header section strats -->
    <header class="header_section">
      <div class="container-fluid" >
        <nav class="navbar navbar-expand-lg custom_nav-container ">
          <a class="navbar-brand" href="{{ url_for('index') }}">
            <span>
              Snow Migrate
            </span>
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class=""> </span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav  ">
              <li class="nav-item ">
                <a class="nav-link" href="{{ url_for('index') }}">Home </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="about.html"> About</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="service.html">Services</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="team.html">Team</a>
              </li>
            </ul>
          </div>
        </nav>
      </div>
    </header>
    <!-- end header section -->
  </div>

    <section class="service_section ">
        <div class=" service_container row2">
            <div class="main2">
                <div class="container" style="margin-top: 50px;">
                    <div class="heading_container heading_center">
                        <h2>BigQuery <span>Schemas</span></h2>
                        <p>Available schemas in the project</p>
                    </div>
                    <form action="/incremental" method="post">
                      <button type="submit" class="connect-btn" style="margin-left: 10px;">Incremental</button>
                    </form>
                    <form id="checkboxForm" action="/snowflake_form" method="post">
                      <div class="row">
                        {% for schema,tables in schemas.items() %}
                        <div class="col-md-4 ">
                          <div class="popup1">
                            <div id="heading1">
                              <input type="checkbox" name="schema" id="schema-{{schema}}" value="{{schema}}">
                              <label for="schema-{{schema}}">{{ schema }}</label>
                            </div>
                            <div class="content1">
                              <ul style="list-style: none;">
                                {% if tables|length < 1 %}
                                <p>No tables available</p>
                                {% else %}
                                {% for table in tables %}
                                <li>
                                  <input type="checkbox" name="table" id="table-{{table}}" value="{{table}}" class="table-checkbox">
                                  <label for="table-{{table}}">{{ table }}
                                  </li>
                                {% endfor %}
                                {% endif %}
                              </ul>
                            </div> 
                          </div>
                        </div>
                        {% endfor %}
                      </div>
                </div>
                <br>
                <button type="button" id="submit-btn" onclick="submitForm()" class="connect-btn">Submit</button>
                </form>
              </div>
            </div>
        </div>
    </section>

 <!-- jQery -->
 <script>/*<![CDATA[*/ 
    function copyC(e,t){
      var o=document.getElementById(e),
      n=document.getElementById(t),
      e=getSelection(),
      t=document.createRange();
      e.removeAllRanges(),
      t.selectNodeContents(n),
      e.addRange(t),document.execCommand("copy"),
      e.removeAllRanges(),o.classList.add("copied"),
      document.getElementById("toastNotif").innerHTML="<span>Copied to Clipboard!</span>",
      setTimeout(()=>{o.classList.remove("copied")},3e3)
    } /*]]>*/
</script>
 <script type="text/javascript" src="js/jquery-3.4.1.min.js"></script>
 <!-- popper js -->
 <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
 </script>
 <!-- bootstrap js -->
 <script type="text/javascript" src="js/bootstrap.js"></script>
 <!-- owl slider -->
 <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js">
 </script>
 <!-- custom js -->
 <script type="text/javascript" src="js/custom.js"></script>
 <!-- Google Map -->
 <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCh39n5U-4IoWpsVGUHWdqB6puEkhRLdmI&callback=myMap">
 </script>
 <!-- End Google Map -->

 <script>
 
  //   document.getElementById("schema_select").addEventListener("submit", function(event) {
  //   // Prevent the default form submission
  //   event.preventDefault();

  //   // Check if at least one checkbox is checked
  //   var checkboxes = document.querySelectorAll('input[type="checkbox"]');
  //   var isChecked = false;
  //   for (var i = 0; i < checkboxes.length; i++) {
  //       if (checkboxes[i].checked) {
  //           isChecked = true;
  //           break;
  //       }
  //   }

  //   // If at least one checkbox is checked, submit the form
  //   if (isChecked) {
  //       this.submit();
  //   } else {
  //       // If no checkbox is checked, display an alert or perform any other action
  //       alert("Please check at least one checkbox before submitting.");
  //       // Or do nothing
  //   }
  // });

  // function toggleTables(schemaCheckbox) {
  //           const tables = schemaCheckbox.parentNode.querySelector('ul').querySelectorAll('input[type="checkbox"]');
  //           tables.forEach(function(table) {
  //               table.checked = schemaCheckbox.checked;
  //           });
  //       }

  function submitForm() {
            const formData = new FormData(document.getElementById('checkboxForm'));
            const schemaTables = {};
           
            formData.forEach(function(value, key) {
                if (key === 'schema') {
                 
                    schemaTables[value] = [];
                } else if (key === 'table') {
                    
                    const lastSchema = Object.keys(schemaTables).pop();
                    schemaTables[lastSchema].push(value);
                }
            });
 
            const jsonData = JSON.stringify(schemaTables);
            
            window.location.href = 'http://127.0.0.1:8000/snowflake_form?'  + new URLSearchParams(jsonData);
        }
</script>
</body>
</html>